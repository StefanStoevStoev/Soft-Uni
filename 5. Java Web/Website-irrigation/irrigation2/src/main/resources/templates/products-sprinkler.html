<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec='http://www.thymeleaf.org/extras/spring-security' xmlns:width="http://www.w3.org/1999/xhtml"
>
<head>
    <th:block th:insert="fragments/fragment :: head"></th:block>
    <title>Мелиорации</title>
    <link rel="stylesheet" th:href="@{/css/styles-sprinkler.css}">
</head>
<body>
<div class="container">
    <nav class="navbar navbar-expand-lg bg-light p-2 mt-4 me-0 ms-0 mask-custom-1" style="--bs-bg-opacity: .7">
        <div class="container fs-5 " id="navbarNav ">
            <ul class="navbar-nav mx-3 ">
                <li class="nav-item ">
                    <a class="nav-link text-dark fw-bold " th:href="@{/}" th:text="#{navbar_home_page}">Заглавна стр.</a>
                </li>
            </ul>
            <ul class="navbar-nav me-2 ">
                <li class="nav-item me-3" sec:authorize="isAuthenticated()">
                    <a class="nav-link text-dark fw-bold " >
                        <th:block th:text="|#{navbar_hello}, |" ></th:block>
                        <!--                        Здравей,-->
                        <!--                        <th:block sec:authentication="name"></th:block>-->
                        <th:block sec:authorize="isAuthenticated()"
                                  th:text="${#authentication.principal.firstName}"></th:block>
                    </a>
                </li>
                <li class="nav-item me-3 " sec:authorize="hasRole('USER')">
                    <form th:method="get"
                          th:action="@{/}">
                        <a type="submit"
                           th:text="#{navbar_my_orders}"
                           class="nav-link text-dark fw-bold "
                           th:href="@{/auth-home/{id}(id=${getUserId})}">Моите поръчки</a>
                    </form>
                </li>
                <li class="nav-item me-3 " sec:authorize="hasRole('ADMIN')">
                    <a class="nav-link text-dark fw-bold " th:text="#{navbar_admin}" th:href="@{/admin}">Админ</a>
                </li>
                <div class="navbar-collapse  me-4" id="navbarNavDarkDropdown">
                    <li class="nav-item dropdown btn-group" id="select-option">
                        <a class="nav-link dropdown-toggle text-dark fw-bold"
                           th:href="@{/}"
                           data-bs-toggle="dropdown"
                           aria-expanded="false">
                            <span th:text="#{navbar_sprinkler}">Разпръскватели<span class="caret"></span></span>
                        </a>
                        <ul id="demolist" class="dropdown-menu dropdown-menu-dark "
                            aria-labelledby="navbarDarkDropdownMenuLink">
                            <li><a class="dropdown-item" th:text="#{navbar_sprinkler}" th:href="@{/products/sprinkler}">Разпръскватели</a></li>
                            <li><a class="dropdown-item" th:text="#{navbar_drip}" th:href="@{/products/drip}">Капково напояване</a></li>
                            <li><a class="dropdown-item" th:text="#{navbar_pump}" th:href="@{/products/pump}">Помпи</a></li>

                        </ul>
                        <p id="demo"></p>
                    </li>
                </div>
                <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
                        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
                        crossorigin="anonymous"></script>
                <li class="nav-item me-3 ">
                    <a class="nav-link text-dark fw-bold " th:text="#{navbar_for_us}" th:href="@{/pages/home}">За нас</a>
                </li>

                <th:block sec:authorize="!isAuthenticated()">
                    <li class="nav-item me-3 ">
                        <a class="nav-link text-dark fw-bold " th:text="#{navbar_login}" th:href="@{/users/login}">Вход</a>
                    </li>
                    <li class="nav-item ">
                        <a class="nav-link text-dark fw-bold " th:text="#{navbar_register}" th:href="@{/users/register}">Регистрация</a>
                    </li>
                </th:block>

                <li class="nav-item me-4 m-2 ps-3">
                    <form th:method="get">
                        <!--                        <label class="text-dark fw-bold" th:text="#{navbar_language}" for="lang"></label>-->
                        <select
                                onchange="this.form.submit()"
                                id="lang"
                                name="lang">
                            <option value="en_US" class=" text-dark" th:selected="${#locale.toString()} == 'en_US'">English</option>
                            <option value="bg_BG" class="text-dark" th:selected="${#locale.toString()} == 'bg_BG'">Български</option>
                        </select>
                    </form>
                </li>

                <th:block sec:authorize="isAuthenticated()">
                    <li class="nav-item me-3 ">
                        <form
                                th:action="@{/users/logout}"
                                th:method="post">
                            <input class="nav-link text-dark fw-bold " type="submit" th:value="#{navbar_exit}">
                        </form>
                    </li>
                </th:block>
            </ul>
        </div>
    </nav>
</div>
<div class="container ">
    <ul class="navbar-nav  mt-3 position-relative ps-5 pe-5">
        <div class="bg-light p-2 mt-2 me-0 ms-0 mask-custom-1"
             th:each="sprinklers : ${getSprinklers}"
             style="--bs-bg-opacity: .6">
            <div class="row pt-2 mb-2 ps-2 " style="height: 34vh; overflow: auto">
                <div class="col-auto ">
                    <img th:src="${sprinklers.url}"
                         class="img-responsive " alt=" ">
                </div>
                <!--                text block-->
                <div class="col" style="width: 300px; height: 130px">
                    <div class="row">
                        <div class="col text-end ps-0 pe-0">
                            <!--                        fs-6 text size-->
                            <p class="fs-6 fw-bold mb-0">Вид:</p>
                            <p class="fs-6 mb-0">Модел:</p>
                            <p class="fs-6 mb-0">Производител:</p>
                            <p class="fs-6 mb-0">Код:</p>
                            <p class="fs-6 mb-0">Размер:</p>
                            <p class="fs-6 mb-0">Налягане:</p>
                            <p class="fs-6 mb-0">Дюза:</p>
                            <p class="fs-6 mb-0">Дебит:</p>
                            <p class="fs-6 mb-0">Радиус:</p>
                        </div>
                        <div class="col-md-auto ms-2 me-2">
                            <!--                        fs-6 text size-->
                            <p class="fs-6 fw-bold mb-0" th:text="${sprinklers.kind}">Вид:</p>
                            <p class="fs-6 mb-0" th:text="${sprinklers.model}">Модел:</p>
                            <p class="fs-6 mb-0" th:text="${sprinklers.make}">Производител:</p>
                            <p class="fs-6 mb-0" th:text="${sprinklers.code}">Код:</p>
                            <p class="fs-6 mb-0" th:text="${sprinklers.size}">Размер:</p>
                            <p class="fs-6 mb-0" th:text="${sprinklers.pressure} ? ${sprinklers.pressure} + ' атм.' : '-'" >Налягане:</p>
                            <p class="fs-6 mb-0" th:text="${sprinklers.nosel} ? ${sprinklers.nosel} + ' mm' : '-'">Дюза:</p>
                            <p class="fs-6 mb-0" th:text="${sprinklers.volume} ? ${sprinklers.volume} + ' л/мин.' : '-'">Дебит:</p>
                            <p class="fs-6 mb-0" th:text="${sprinklers.radius} ? ${sprinklers.radius} + ' m' : '-'">Радиус:</p>

                        </div>
                        <div class="col ps-0 pe-0 text-center">
                            <div class="row container pt-3 pb-2 mb-2">
                                <div class="col text-end">
                                    <p class="fs-6 mb-0">Единична цена:</p>
                                    <p class="fs-6 mb-0">Наличност:</p>
                                    <p class="fs-6 mb-0">Стойност:</p>
                                </div>
                                <div class="col text-start ">
                                    <p class="fs-6  mb-0 single-price"
                                       th:value="${sprinklers.price}"
                                       th:text="|${sprinklers.price} лв.|">
                                        Единична цена</p>
                                    <p class="fs-6 mb-0 availability"
                                       th:value="${sprinklers.pieces}"
                                       th:text="|${sprinklers.pieces} бр.|">Наличност:</p>
                                    <p class="fs-6  mb-0 price2"
                                       th:text="|${sprinklers.price} лв.|"></p>
                                </div>
                            </div>
                            <div class="input-spinner" th:high="50vh">
                                <button onclick="stepper(this)"
                                        class="text-center decrement"
                                        style="width: 2vh">
                                    -
                                </button>
                                <input type="number"
                                       min="1"
                                       max="100"
                                       step="1"
                                       value="1"
                                       class="my-input" readonly>
                                <button onclick="stepper(this)"
                                        class="text-center increment"
                                        style="width: 2vh">
                                    +
                                </button>

                            </div>
                            <th:block th:unless="${#authorization.expression('hasRole(''ADMIN'')')}">
                                <form th:method="post"
                                      th:action="@{/products/sprinkler}"
                                      th:object="${sprinklerDTO}"
                                      class="button-holder d-flex justify-content-center mt-2">
                                    <label th:type="hidden" style="display:none"></label>
                                    <input th:type="hidden"
                                         th:methodParam="${sprinklers.id}"
                                         class=" id"
                                         name="id"
                                         th:value="${sprinklers.id}"
                                         style="display:none">
                                    <label th:type="hidden" style="display:none"></label>
                                    <input th:type="hidden"
                                         class=" price"
                                         name="price"
                                         style="display:none">
                                    <label th:type="hidden" style="display:none"></label>
                                    <input th:type="hidden"
                                         class=" pieces"
                                         name="pieces"
                                         style="display:none">
                                    </input>
                                    <th:block sec:authorize="isAuthenticated()">
                                        <button
                                           class="btn btn-warning mb-1"
                                           onclick="setAttributeData(this)">Купи
                                        </button>
                                    </th:block>
                                    <th:block sec:authorize="isAnonymous()">
                                        <a type="submit" class="btn btn-warning mb-1"
                                           th:href="@{/users/login}">Купи</a>
                                    </th:block>
                                </form>
                            </th:block>

                        </div>
                    </div>

                </div>
            </div>
        </div>
    </ul>
</div>
<script  type="text/javascript" th:inline="javascript"></script>
<footer th:replace="fragments/fragment::footer"></footer>
</body>
</html>